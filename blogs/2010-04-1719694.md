# MOSS 2010:Visual Studio 2010开发体验（10）&mdash;&mdash;列表开发之内容类型 
> 原文发表于 2010-04-25, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/25/1719694.html 


<p>上一篇，我讲到了列表的一些基本概念</p> <p><a title="http://www.cnblogs.com/chenxizhang/archive/2010/04/24/1719467.html" href="http://www.cnblogs.com/chenxizhang/archive/2010/04/24/1719467.html">http://www.cnblogs.com/chenxizhang/archive/2010/04/24/1719467.html</a></p> <p>1. 内容类型(Content Type)</p> <blockquote> <p>里面会包含栏位定义（Field）</p></blockquote> <p>2. 列表定义（List Definition)</p> <p>3. 列表实例（List Instance）</p> <p>&nbsp;</p> <p>接下来，我们先来看一下内容类型，应该如何在Visual Studio中来定义和实现。</p> <p>我们的目的是定义这样一个内容类型，它是用来填写订单信息的，它包含了如下三个栏位</p> <p>1.订购编号（数字）</p> <p>2.客户编号（文字）</p> <p>3.订购日期（日期）</p> <p>为了易于大家理解和学习，我预先通过在网站中手工添加的方式已经做出来了该内容类型，如下图所示 </p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_2.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb.png" width="1044" height="810"></a> </p> <p>我们接下来，通过编程的方式查看一下这个类型的具体定义是怎么样的</p> <p>【注意】目前我并没有发现有什么内置工具可以直接导出内容类型的定义。虽然确实有第三方的一个工具（Solution Generator)可以做，但我还是自己写了几句代码</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_4.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_1.png" width="1044" height="810"></a> </p><pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> Microsoft.SharePoint;

<span class="kwrd">namespace</span> ConsoleApplication1
{
    <span class="kwrd">class</span> Program
    {
        <span class="kwrd">static</span> <span class="kwrd">void</span> Main(<span class="kwrd">string</span>[] args)
        {

            Console.SetOut(<span class="kwrd">new</span> System.IO.StreamWriter(<span class="str">"output.xml"</span>));

            <span class="kwrd">using</span> (SPSite site = <span class="kwrd">new</span> SPSite(<span class="str">"http://nymoss2010:45223/Sites/dev"</span>))
            {
                <span class="kwrd">using</span> (SPWeb web = site.OpenWeb())
                {

                    var query = (from SPContentType type <span class="kwrd">in</span> web.ContentTypes
                                <span class="kwrd">where</span> type.Name == <span class="str">"订单列表"</span>
                                select type).FirstOrDefault();

                    <span class="kwrd">if</span> (query != <span class="kwrd">null</span>)
                        Console.WriteLine(query.SchemaXml);
                }
            }

            Console.Out.Close();


        }
    }
}
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>这个小程序，可以返回如下一个XML文件</p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">ContentType</span> <span class="attr">ID</span><span class="kwrd">="0x0100D65EF902CB376049B444A07F18A80074"</span> <span class="attr">Name</span><span class="kwrd">="订单列表"</span> <span class="attr">Group</span><span class="kwrd">="自定义内容类型"</span> <span class="attr">Version</span><span class="kwrd">="3"</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">Folder</span> <span class="attr">TargetName</span><span class="kwrd">="_cts/订单列表"</span> <span class="kwrd">/&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">Fields</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">ID</span><span class="kwrd">="{c042a256-787d-4a6f-8a8a-cf6ab767f12d}"</span> <span class="attr">Name</span><span class="kwrd">="ContentType"</span> <span class="attr">SourceID</span><span class="kwrd">="http://schemas.microsoft.com/sharepoint/v3"</span> <span class="attr">StaticName</span><span class="kwrd">="ContentType"</span> <span class="attr">Group</span><span class="kwrd">="_Hidden"</span> <span class="attr">Type</span><span class="kwrd">="Computed"</span> <span class="attr">DisplayName</span><span class="kwrd">="内容类型"</span> <span class="attr">ReadOnly</span><span class="kwrd">="TRUE"</span> <span class="attr">Sealed</span><span class="kwrd">="TRUE"</span> <span class="attr">Sortable</span><span class="kwrd">="FALSE"</span> <span class="attr">RenderXMLUsingPattern</span><span class="kwrd">="TRUE"</span> <span class="attr">PITarget</span><span class="kwrd">="MicrosoftWindowsSharePointServices"</span> <span class="attr">PIAttribute</span><span class="kwrd">="ContentTypeID"</span> <span class="attr">Customization</span><span class="kwrd">=""</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">FieldRefs</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">FieldRef</span> <span class="attr">ID</span><span class="kwrd">="{03e45e84-1992-4d42-9116-26f756012634}"</span> <span class="attr">Name</span><span class="kwrd">="ContentTypeId"</span> <span class="kwrd">/&gt;</span>
      <span class="kwrd">&lt;/</span><span class="html">FieldRefs</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">DisplayPattern</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">MapToContentType</span><span class="kwrd">&gt;</span>
          <span class="kwrd">&lt;</span><span class="html">Column</span> <span class="attr">Name</span><span class="kwrd">="ContentTypeId"</span> <span class="kwrd">/&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">MapToContentType</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;/</span><span class="html">DisplayPattern</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">Field</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">ID</span><span class="kwrd">="{fa564e0f-0c70-4ab9-b863-0177e6ddd247}"</span> <span class="attr">Name</span><span class="kwrd">="Title"</span> <span class="attr">SourceID</span><span class="kwrd">="http://schemas.microsoft.com/sharepoint/v3"</span> <span class="attr">StaticName</span><span class="kwrd">="Title"</span> <span class="attr">Group</span><span class="kwrd">="_Hidden"</span> <span class="attr">Type</span><span class="kwrd">="Text"</span> <span class="attr">DisplayName</span><span class="kwrd">="标题"</span> <span class="attr">Required</span><span class="kwrd">="TRUE"</span> <span class="attr">FromBaseType</span><span class="kwrd">="TRUE"</span> <span class="attr">Customization</span><span class="kwrd">=""</span> <span class="attr">ShowInNewForm</span><span class="kwrd">="TRUE"</span> <span class="attr">ShowInEditForm</span><span class="kwrd">="TRUE"</span> <span class="kwrd">/&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">Type</span><span class="kwrd">="Number"</span> <span class="attr">DisplayName</span><span class="kwrd">="订单编号"</span> <span class="attr">Required</span><span class="kwrd">="FALSE"</span> <span class="attr">EnforceUniqueValues</span><span class="kwrd">="FALSE"</span> <span class="attr">Indexed</span><span class="kwrd">="FALSE"</span> <span class="attr">Group</span><span class="kwrd">="自定义栏"</span> <span class="attr">IMEMode</span><span class="kwrd">="inactive"</span> <span class="attr">ID</span><span class="kwrd">="{6951653a-c02e-4440-a918-54dc6c6b4ad4}"</span> <span class="attr">SourceID</span><span class="kwrd">="{bc8f77ac-9814-448d-9c64-159c9680ecfd}"</span> <span class="attr">StaticName</span><span class="kwrd">="_x008ba2__x005355__x007f16__x0053f7_"</span> <span class="attr">Name</span><span class="kwrd">="_x008ba2__x005355__x007f16__x0053f7_"</span> <span class="attr">Customization</span><span class="kwrd">=""</span> <span class="kwrd">/&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">Type</span><span class="kwrd">="DateTime"</span> <span class="attr">DisplayName</span><span class="kwrd">="订购日"</span> <span class="attr">Required</span><span class="kwrd">="FALSE"</span> <span class="attr">EnforceUniqueValues</span><span class="kwrd">="FALSE"</span> <span class="attr">Indexed</span><span class="kwrd">="FALSE"</span> <span class="attr">Format</span><span class="kwrd">="DateOnly"</span> <span class="attr">Group</span><span class="kwrd">="自定义栏"</span> <span class="attr">IMEMode</span><span class="kwrd">="inactive"</span> <span class="attr">ID</span><span class="kwrd">="{308eac8d-86ca-49e9-a65c-43bac42bb9c4}"</span> <span class="attr">SourceID</span><span class="kwrd">="{bc8f77ac-9814-448d-9c64-159c9680ecfd}"</span> <span class="attr">StaticName</span><span class="kwrd">="_x008ba2__x008d2d__x0065e5_"</span> <span class="attr">Name</span><span class="kwrd">="_x008ba2__x008d2d__x0065e5_"</span> <span class="attr">Customization</span><span class="kwrd">=""</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">Default</span><span class="kwrd">&gt;</span>[today]<span class="kwrd">&lt;/</span><span class="html">Default</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">Field</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">Type</span><span class="kwrd">="Text"</span> <span class="attr">DisplayName</span><span class="kwrd">="客户编号"</span> <span class="attr">Required</span><span class="kwrd">="FALSE"</span> <span class="attr">EnforceUniqueValues</span><span class="kwrd">="FALSE"</span> <span class="attr">Indexed</span><span class="kwrd">="FALSE"</span> <span class="attr">MaxLength</span><span class="kwrd">="255"</span> <span class="attr">Group</span><span class="kwrd">="自定义栏"</span> <span class="attr">ID</span><span class="kwrd">="{442bcf2b-554b-4f53-8877-8612d85cbb8e}"</span> <span class="attr">SourceID</span><span class="kwrd">="{bc8f77ac-9814-448d-9c64-159c9680ecfd}"</span> <span class="attr">StaticName</span><span class="kwrd">="_x005ba2__x006237__x007f16__x0053f7_"</span> <span class="attr">Name</span><span class="kwrd">="_x005ba2__x006237__x007f16__x0053f7_"</span> <span class="attr">Customization</span><span class="kwrd">=""</span> <span class="kwrd">/&gt;</span>
  <span class="kwrd">&lt;/</span><span class="html">Fields</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">XmlDocuments</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">XmlDocument</span> <span class="attr">NamespaceURI</span><span class="kwrd">="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms"</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">FormTemplates</span> <span class="attr">xmlns</span><span class="kwrd">="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">Display</span><span class="kwrd">&gt;</span>ListForm<span class="kwrd">&lt;/</span><span class="html">Display</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">Edit</span><span class="kwrd">&gt;</span>ListForm<span class="kwrd">&lt;/</span><span class="html">Edit</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">New</span><span class="kwrd">&gt;</span>ListForm<span class="kwrd">&lt;/</span><span class="html">New</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;/</span><span class="html">FormTemplates</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">XmlDocument</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;/</span><span class="html">XmlDocuments</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">ContentType</span><span class="kwrd">&gt;</span>
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>【注意】你可能会说，这样做是不是太麻烦了呢？的确不是很方便，我下面会做一个工具来改善这一点。</p>
<p>&nbsp;</p>
<p>好了，到这里为止，我们就大致明白了，一个内容类型其实是一个XML定义，那么我们如何来在Visual Studio中来定义它呢</p>
<p>1. 首先创建一个Empty Project</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_6.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_2.png" width="1044" height="810"></a> </p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_8.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_3.png" width="1044" height="810"></a> </p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_10.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_4.png" width="1044" height="810"></a> </p>
<p>2. 添加一个内容类型</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_12.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_5.png" width="1044" height="810"></a> </p>
<p>将父内容类型设置为“项目”</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_14.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_6.png" width="1044" height="810"></a> </p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_16.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_7.png" width="1044" height="810"></a> </p>
<p>【注意】上面默认生成的XML定义中，inherits确实会出错，我们干脆删除它先</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_18.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_8.png" width="1044" height="810"></a> </p>
<p>&nbsp;</p>
<p>3. 修改内容类型栏位定义</p>
<p>还记得之前那段XML吗？我们需要类似下面的语法定义栏位即可</p><pre class="csharpcode">    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">Type</span><span class="kwrd">="Number"</span> <span class="attr">DisplayName</span><span class="kwrd">="订单编号"</span> <span class="attr">Required</span><span class="kwrd">="FALSE"</span> <span class="attr">EnforceUniqueValues</span><span class="kwrd">="FALSE"</span> <span class="attr">Indexed</span><span class="kwrd">="FALSE"</span> <span class="attr">Group</span><span class="kwrd">="自定义栏"</span> <span class="attr">IMEMode</span><span class="kwrd">="inactive"</span> <span class="attr">ID</span><span class="kwrd">="{6951653a-c02e-4440-a918-54dc6c6b4ad4}"</span> <span class="attr">SourceID</span><span class="kwrd">="{bc8f77ac-9814-448d-9c64-159c9680ecfd}"</span> <span class="attr">StaticName</span><span class="kwrd">="_x008ba2__x005355__x007f16__x0053f7_"</span> <span class="attr">Name</span><span class="kwrd">="_x008ba2__x005355__x007f16__x0053f7_"</span> <span class="attr">Customization</span><span class="kwrd">=""</span> <span class="kwrd">/&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">Type</span><span class="kwrd">="DateTime"</span> <span class="attr">DisplayName</span><span class="kwrd">="订购日"</span> <span class="attr">Required</span><span class="kwrd">="FALSE"</span> <span class="attr">EnforceUniqueValues</span><span class="kwrd">="FALSE"</span> <span class="attr">Indexed</span><span class="kwrd">="FALSE"</span> <span class="attr">Format</span><span class="kwrd">="DateOnly"</span> <span class="attr">Group</span><span class="kwrd">="自定义栏"</span> <span class="attr">IMEMode</span><span class="kwrd">="inactive"</span> <span class="attr">ID</span><span class="kwrd">="{308eac8d-86ca-49e9-a65c-43bac42bb9c4}"</span> <span class="attr">SourceID</span><span class="kwrd">="{bc8f77ac-9814-448d-9c64-159c9680ecfd}"</span> <span class="attr">StaticName</span><span class="kwrd">="_x008ba2__x008d2d__x0065e5_"</span> <span class="attr">Name</span><span class="kwrd">="_x008ba2__x008d2d__x0065e5_"</span> <span class="attr">Customization</span><span class="kwrd">=""</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">Default</span><span class="kwrd">&gt;</span>[today]<span class="kwrd">&lt;/</span><span class="html">Default</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">Field</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Field</span> <span class="attr">Type</span><span class="kwrd">="Text"</span> <span class="attr">DisplayName</span><span class="kwrd">="客户编号"</span> <span class="attr">Required</span><span class="kwrd">="FALSE"</span> <span class="attr">EnforceUniqueValues</span><span class="kwrd">="FALSE"</span> <span class="attr">Indexed</span><span class="kwrd">="FALSE"</span> <span class="attr">MaxLength</span><span class="kwrd">="255"</span> <span class="attr">Group</span><span class="kwrd">="自定义栏"</span> <span class="attr">ID</span><span class="kwrd">="{442bcf2b-554b-4f53-8877-8612d85cbb8e}"</span> <span class="attr">SourceID</span><span class="kwrd">="{bc8f77ac-9814-448d-9c64-159c9680ecfd}"</span> <span class="attr">StaticName</span><span class="kwrd">="_x005ba2__x006237__x007f16__x0053f7_"</span> <span class="attr">Name</span><span class="kwrd">="_x005ba2__x006237__x007f16__x0053f7_"</span> <span class="attr">Customization</span><span class="kwrd">=""</span> <span class="kwrd">/&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>我们如法炮制，添加到Elements文件中去</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_20.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_9.png" width="1044" height="810"></a> </p>
<p>【注意】要添加在ContentType元素的外面，而不是里面</p>
<p>【注意】你可能需要修改一下有关的ID，这个可以通过Tools==&gt;Create GUID这个工具来做到</p>
<p>&nbsp;</p>
<p>接下来，我们建立内容类型与栏位的关系（称为所有的引用）</p><pre class="csharpcode">    <span class="kwrd">&lt;</span><span class="html">FieldRefs</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">FieldRef</span> <span class="attr">ID</span><span class="kwrd">="{6951653a-c02e-4440-a918-54dc6c6b4ad4}"</span><span class="kwrd">/&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">FieldRef</span> <span class="attr">ID</span><span class="kwrd">="{308eac8d-86ca-49e9-a65c-43bac42bb9c4}"</span><span class="kwrd">/&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">FieldRef</span> <span class="attr">ID</span><span class="kwrd">="{442bcf2b-554b-4f53-8877-8612d85cbb8e}"</span><span class="kwrd">/&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">FieldRefs</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_22.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_10.png" width="1044" height="810"></a> </p>
<p>&nbsp;</p>
<p>4. 部署内容类型</p>
<p>完成上面的操作之后，就可以来部署看看效果了。请按下CTRL+F5键，部署将产生如下的一些输出</p>
<p>------ Build started: Project: OrderListSolution, Configuration: Debug Any CPU ------<br>&nbsp; OrderListSolution -&gt; c:\users\administrator\documents\visual studio 2010\Projects\OrderListSolution\OrderListSolution\bin\Debug\OrderListSolution.dll<br>&nbsp; Successfully created package at: c:\users\administrator\documents\visual studio 2010\Projects\OrderListSolution\OrderListSolution\bin\Debug\OrderListSolution.wsp<br>------ Deploy started: Project: OrderListSolution, Configuration: Debug Any CPU ------<br>Active Deployment Configuration: Default<br>Run Pre-Deployment Command:<br>&nbsp; Skipping deployment step because a pre-deployment command is not specified.<br>Recycle IIS Application Pool:<br>&nbsp; Skipping application pool recycle because no matching package on the server was found.<br>Retract Solution:<br>&nbsp; Skipping package retraction because no matching package on the server was found.<br>Add Solution:<br>&nbsp; Adding solution 'OrderListSolution.wsp'...<br>&nbsp; Deploying solution 'OrderListSolution.wsp'...<br>Activate Features:<br>&nbsp; Activating feature 'Feature1' ...<br>Run Post-Deployment Command:<br>&nbsp; Skipping deployment step because a post-deployment command is not specified.<br>========== Build: 1 succeeded or up-to-date, 0 failed, 0 skipped ==========<br>========== Deploy: 1 succeeded, 0 failed, 0 skipped ==========
<p>&nbsp;</p>
<p>部署如果成功的话，会自动打开我们的网站。为了作为测试，我单独创建了一个OrderList的列表（此步骤略过）</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_24.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_11.png" width="1044" height="810"></a> </p>
<p>添加内容类型</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_26.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_12.png" width="1044" height="810"></a> </p>
<p></p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_28.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_13.png" width="1044" height="810"></a> </p>
<p>下面我们来看看如何使用该内容类型</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_30.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_14.png" width="1044" height="810"></a> </p>
<p></p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_32.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201010_5F73/image_thumb_15.png" width="1044" height="810"></a> </p>
<p>好，到这里为止，我们就在Visual Studio中实现了一个自定义内容类型，而且将它部署到了网站，然后在一个列表中使用了它。</p>
<p>但是，问题是，如果每次都需要我们手工来建立列表与内容类型的联系，其实还是比较繁琐的。有没有办法让一个列表自动地就关联到某个内容类型呢？</p>
<p>当然可以的，我们下面就会介绍列表定义和列表实例的实现。</p>