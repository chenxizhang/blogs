# WPF：如何为程序添加splashScreen？ 
> 原文发表于 2010-03-25, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/03/25/1694606.html 


<p>大家是否还记得在Windows Forms程序中如何实现splashScreen吗？我们一般都会使用Microsoft.VisualBasic.dll中提供的那个WindowsFormsApplicationBase类型，它有一个所谓的splashscreen属性，可以指定为一个窗体的。</p> <p>那么，同样的需求在WPF中如何实现呢？这要从两头来说，从简单来说，它实在是简单了。</p> <p>事实上，这是.NET Framework 3.5sp1的一个特性</p> <p><a title="http://blogs.msdn.com/jgoldb/archive/2008/08/12/what-s-new-in-wpf-3-5-sp1-splash-screen-to-improve-perceived-startup-perf.aspx" href="http://blogs.msdn.com/jgoldb/archive/2008/08/12/what-s-new-in-wpf-3-5-sp1-splash-screen-to-improve-perceived-startup-perf.aspx">http://blogs.msdn.com/jgoldb/archive/2008/08/12/what-s-new-in-wpf-3-5-sp1-splash-screen-to-improve-perceived-startup-perf.aspx</a></p> <p>&nbsp;</p> <p>&nbsp;</p> <p>考虑到大部分的splashscreen其实都只是一个图片，所以最简单的做法是，先导入一张图片，然后设置它的生成操作为“splash screen”</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_4.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_thumb_1.png" width="963" height="732"></a> </p> <p>注意,其他什么都不要做,此时运行程序的话,就可以看到效果</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_8.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_thumb_3.png" width="485" height="258"></a> </p> <p>注意：虽然我们的图片是gif的格式，但显示出来的效果却是静态的。</p> <p>&nbsp;</p> <p>那么，到底发生了什么，让他具有了这个特性呢？我们可以打开项目的文件，就是那个csproj文件</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_10.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_thumb_4.png" width="895" height="510"></a>&nbsp;</p> <p>原来它是通过在项目文件中声明一个SplashScreen来实现的。</p> <p>[注意]这个文件是给msbuild这个工具用的。</p> <p>[思考]所以试想一下，一个应用程序是否可以有多个SplashScreen呢？</p> <p>&nbsp;</p> <p>同时，我们还可以打开IL代码来了解一下，</p> <p></p> <p></p> <p></p> <p></p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_12.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_thumb_5.png" width="866" height="717"></a> </p> <p>从上面的il代码可以很直观地看出来，其实它是先实例化了一个SplashScreen，然后调用了它的Show方法而已。</p> <p>如果是这样的话，我们当然也可以自己写代码来实现</p> <p>首先，让我们将图片的生成操作修改为“嵌入的资源”</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_14.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WPFsplashScreen_DE37/image_thumb_6.png" width="314" height="421"></a> </p> <p>然后通过下面的代码就可以实现功能</p><pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Configuration;
<span class="kwrd">using</span> System.Data;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> System.Windows;

<span class="kwrd">namespace</span> WpfApplication1
{
    <span class="rem">/// &lt;summary&gt;</span>
    <span class="rem">/// App.xaml 的交互逻辑</span>
    <span class="rem">/// &lt;/summary&gt;</span>
    <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> App : Application
    {
        <span class="kwrd">protected</span> <span class="kwrd">override</span> <span class="kwrd">void</span> OnStartup(StartupEventArgs e)
        {
            SplashScreen s = <span class="kwrd">new</span> SplashScreen(<span class="str">"20080320132823923.gif"</span>);
            s.Show(<span class="kwrd">true</span>);

            <span class="kwrd">base</span>.OnStartup(e);
        }
    }
}

</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p></p>
<p>值得一提的是，目前看来，也没有办法加载一个窗口作为SplashScreen。</p>
<p>如果希望闪屏至少显示多少时间，则可以考虑下面的代码</p><pre class="csharpcode">            SplashScreen s = <span class="kwrd">new</span> SplashScreen(<span class="str">"20080320132823923.gif"</span>);
            s.Show(<span class="kwrd">false</span>);
            s.Close(<span class="kwrd">new</span> TimeSpan(0, 0, 10));</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>