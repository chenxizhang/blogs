# MOSS 2010：Visual Studio 2010开发体验（1）&mdash;&mdash;SharePoint Explorer 
> 原文发表于 2010-04-05, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/05/1704680.html 


<p>你不得不感概，原先在MOSS 2007的时代我们是多么辛苦。不是吗？</p> <ul> <li>Visual Studio 开发体验受到局限<br>适用于 WSS 的 Visual Studio 扩展<br>Visual Studio Tools for Office 与 VS2008 之间的配合<br>SharePoint 开发人员需要依赖于社区工具  <li>开发人员不得不应对层出不穷的细节工作<br>手工编辑 CAML 文件<br>熟悉 WSS 的 RootFiles 目录<br>手工编辑 manifest.xml 文件<br>为解决方案包构建 .wsp 文件</li></ul> <p>&nbsp;</p> <p>是的 ，对这些痛苦我们记忆犹新。好吧，现在是时候改变了</p> <ul> <li>SharePoint 2010 采用端到端的开发体验<br>用于浏览网站的 SharePoint Explorer<br>SharePoint 2010 项目与组件模板<br>适用于各种主要应用场景的可视化设计环境<br>为 Visual Studio 2008 for WSS 3.0 提供迁移路径<br>可由第三方开发人员进行扩展  <li>SharePoint 开发人员的好消息<br>实现 RootFiles 目录细节的简化<br>实现 .wsp 文件构建工作的简化<br>减少/避免对外部工具的使用需求</li></ul> <p>&nbsp;</p> <p>当然，前提是，你得拥有Visual Studio 2010,而且最好是装在服务器上面。听我的吧，这样可以避免很多问题，节省大量的时间。</p> <h3>这一讲介绍一下SharePoint Explorer</h3> <p>这个工具是集成在Server Explorer中的</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio1SharePointExplorer_D5A6/image_4.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio1SharePointExplorer_D5A6/image_thumb_1.png" width="1044" height="810"></a> </p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio1SharePointExplorer_D5A6/image_2.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio1SharePointExplorer_D5A6/image_thumb.png" width="1044" height="810"></a> </p> <p>很显然有了这个工具，就可以更好地理解一个SharePoint站点的结构了。目前这个工具，除了让开发人员更好地浏览SharePoint站点内容结构之外，如果我们在Lists上面去点击右键的话，还可以直接点位到该列表</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio1SharePointExplorer_D5A6/image_14.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio1SharePointExplorer_D5A6/image_thumb_6.png" width="1044" height="810"></a> </p> <p></p> <p>我觉得这个工具还不是很完善，以后可能会更加强一些。例如直接可以拖拽到程序界面上这样的功能</p> <p>&nbsp;</p> <p>关于 Explorer的扩展，如果有兴趣的朋友，可以参考下面的链接</p> <p><a href="http://msdn.microsoft.com/en-us/library/ee471438(VS.100).aspx">http://msdn.microsoft.com/en-us/library/ee471438(VS.100).aspx</a></p> <p>&nbsp;</p> <p>下面是有一个例子</p><pre class="csharpcode"><span class="kwrd">using</span> System.ComponentModel;
<span class="kwrd">using</span> System.ComponentModel.Composition;
<span class="kwrd">using</span> System.Windows.Forms;
<span class="kwrd">using</span> Microsoft.VisualStudio.SharePoint;
<span class="kwrd">using</span> Microsoft.VisualStudio.SharePoint.Explorer;
<span class="kwrd">using</span> Microsoft.VisualStudio.SharePoint.Explorer.Extensions;

<span class="kwrd">namespace</span> Contoso.ServerExplorerExtension
{
    [Export(<span class="kwrd">typeof</span>(IExplorerNodeTypeExtension))]
    [ExplorerNodeType(ExplorerNodeTypes.SiteNode)]
    <span class="kwrd">internal</span> <span class="kwrd">class</span> SiteNodeExtensionWithContextMenu : IExplorerNodeTypeExtension
    {
        <span class="kwrd">public</span> <span class="kwrd">void</span> Initialize(IExplorerNodeType nodeType)
        {
            nodeType.NodeMenuItemsRequested += nodeType_NodeMenuItemsRequested;
        }

        <span class="kwrd">void</span> nodeType_NodeMenuItemsRequested(<span class="kwrd">object</span> sender, ExplorerNodeMenuItemsRequestedEventArgs e)
        {
            IMenuItem menuItem = e.MenuItems.Add(<span class="str">"Display Message"</span>);
            menuItem.Click += menuItem_Click;
        }

        <span class="kwrd">void</span> menuItem_Click(<span class="kwrd">object</span> sender, MenuItemEventArgs e)
        {
            IExplorerNode node = (IExplorerNode)e.Owner;
            MessageBox.Show(<span class="kwrd">string</span>.Format(<span class="str">"Clicked the menu item for the '{0}' node."</span>, node.Text));
        }
    }

    [Export(<span class="kwrd">typeof</span>(IExplorerNodeTypeExtension))]
    [ExplorerNodeType(ExtensionNodeTypes.FieldNode)]
    <span class="kwrd">internal</span> <span class="kwrd">class</span> FieldNodeExtensionWithProperty : IExplorerNodeTypeExtension
    {
        <span class="kwrd">public</span> <span class="kwrd">void</span> Initialize(IExplorerNodeType nodeType)
        {
            nodeType.NodePropertiesRequested += nodeType_NodePropertiesRequested;
        }

        <span class="kwrd">void</span> nodeType_NodePropertiesRequested(<span class="kwrd">object</span> sender, ExplorerNodePropertiesRequestedEventArgs e)
        {
            <span class="rem">// Only add the property to "Body" fields.</span>
            <span class="kwrd">if</span> (e.Node.Text == <span class="str">"Body"</span>)
            {
                ExampleProperty propertyObject;

                <span class="rem">// If the properties object already exists for this node, get it from the node's annotations.</span>
                <span class="kwrd">if</span> (!e.Node.Annotations.TryGetValue(<span class="kwrd">out</span> propertyObject))
                {
                    <span class="rem">// Otherwise, create a new properties object and add it to the annotations.</span>
                    propertyObject = <span class="kwrd">new</span> ExampleProperty(e.Node);
                    e.Node.Annotations.Add(propertyObject);
                }

                e.PropertySources.Add(propertyObject);
            }
        }
    }

    <span class="kwrd">internal</span> <span class="kwrd">class</span> ExampleProperty
    {
        <span class="kwrd">private</span> IExplorerNode node;
        <span class="kwrd">private</span> <span class="kwrd">const</span> <span class="kwrd">string</span> propertyId = <span class="str">"Contoso.ExampleProperty"</span>;
        <span class="kwrd">private</span> <span class="kwrd">const</span> <span class="kwrd">string</span> propertyDefaultValue = <span class="str">"This is an example property."</span>;

        <span class="kwrd">internal</span> ExampleProperty(IExplorerNode node)
        {
            <span class="kwrd">this</span>.node = node;
        }

        <span class="rem">// Gets or sets a simple string property. </span>
        [DisplayName(<span class="str">"ContosoExampleProperty"</span>)]
        [DescriptionAttribute(<span class="str">"This is an example property for field nodes."</span>)]
        [DefaultValue(propertyDefaultValue)]
        <span class="kwrd">public</span> <span class="kwrd">string</span> TestProperty
        {
            get
            {
                <span class="kwrd">string</span> propertyValue;

                <span class="rem">// Get the current property value if it already exists; otherwise, return a default value.</span>
                <span class="kwrd">if</span> (!node.Annotations.TryGetValue(propertyId, <span class="kwrd">out</span> propertyValue))
                {
                    propertyValue = propertyDefaultValue;
                }
                <span class="kwrd">return</span> propertyValue;
            }
            set
            {
                <span class="kwrd">if</span> (<span class="kwrd">value</span> != propertyDefaultValue)
                {
                    <span class="rem">// Store the property value in the Annotations property of the node. </span>
                    <span class="rem">// Data in the Annotations property does not persist when Visual Studio exits.</span>
                    node.Annotations[propertyId] = <span class="kwrd">value</span>;
                }
                <span class="kwrd">else</span>
                {
                    <span class="rem">// Do not save the default value.</span>
                    node.Annotations.Remove(propertyId);
                }
            }
        }
    }

}</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>