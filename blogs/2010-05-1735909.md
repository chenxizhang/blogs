# MOSS 2010:Visual Studio 2010开发体验（33）&mdash;&mdash;工作流开发最佳实践（五）：全局可重用工作流 
> 原文发表于 2010-05-15, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/05/15/1735909.html 


<p><a href="http://www.cnblogs.com/chenxizhang/archive/2010/05/14/1735816.html">上一篇</a>我们讨论到了可重用工作流，看起来还不错：现在一个工作流可以比较灵活地根据需要与不同的列表关联了。</p> <p>但还是让我们稍作思考这个重用的话题吧，既然说到重用，就自然还要问一下：那么它到底在什么范围之内重用呢？</p> <p><strong><font color="#ff0000">默认情况下，我们通过上一篇创建的可重用工作流只能在当前网站间共用。</font></strong></p> <p>但我们确实可以设计在更广范围重用的工作流，（例如在整个网站集中重用），现在它有一个专门的称呼：<strong>全局可重用工作流</strong>。</p> <p>事实上，MOSS 2010自带了三个所谓的全局可重用工作流。</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_2.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb.png" width="1030" height="408"></a> </p> <p>那么，我们怎么创建自己的“全局可重用工作流”呢？</p> <p>【注意】全局可重用工作流必须在网站集的首要站点进行开发。</p> <p>&nbsp;</p> <h2>第一步：创建一个“可重用工作流”</h2> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_4.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb_1.png" width="704" height="530"></a> </p> <p>【备注】至于怎么设计工作流，乃至如何设置可重用工作流，因为之前做过专门的介绍，这里就不重复了</p> <p>&nbsp;</p> <h2>第二步：发布为全局可重用工作流</h2> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_6.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb_2.png" width="883" height="311"></a> </p> <p></p> <p></p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_8.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb_3.png" width="802" height="161"></a> </p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_10.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb_4.png" width="1032" height="209"></a> </p> <h2>第三步：在子级网站中使用该工作流</h2> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_12.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb_5.png" width="769" height="408"></a> </p> <p></p> <p></p> <p>【注意】这是我刚才建立的一个子网站，请注意看地址</p> <p>&nbsp;</p> <h2>总结：</h2> <p>这一篇我通过例子讲解了如何实现全局可重用的工作流。其实，说是全局，并非那么准确的，因为我们通过SharePoint Designer做出来的所谓“全局可重用工作流”其实是只能在一个网站集中重用。例如，假设我们切换到另外一个网站集，你是不可能看到那个工作流的。如下图所示</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_14.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201033_6E3D/image_thumb_6.png" width="764" height="408"></a> </p> <p>那么，有没有办法实现在不同网站集都能重用的工作流呢？答案是可以的，只是我们需要用到Visual Studio 。让我们后面的文章专门来讨论一下这个问题吧</p>