# MOSS 2010: Visual Studio 2010开发体验(3)&mdash;&mdash;调试代码 
> 原文发表于 2010-04-05, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/05/1704735.html 


<p>这一篇来谈谈在Visual Studio 2010中直接进行代码调试的功能。我们可以简单地做一个WebPart来实验这个功能</p> <p>关于VS2010的项目模板和结构，请参考上一篇<a href="http://www.cnblogs.com/chenxizhang/archive/2010/04/05/1704701.html">http://www.cnblogs.com/chenxizhang/archive/2010/04/05/1704701.html</a></p> <p>我们来快速创建一个WebPart项目吧</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_4.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_1.png" width="1044" height="810"></a> </p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_6.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_2.png" width="1044" height="810"></a> </p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_8.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_3.png" width="1044" height="810"></a> </p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_10.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_4.png" width="1044" height="810"></a> </p> <p>为了看到调试的效果，我们可以设置一个断点</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_12.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_5.png" width="1044" height="810"></a> </p> <p>&nbsp;</p> <p>现在，好戏开始了，请按下F5键</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_14.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_6.png" width="1044" height="810"></a> </p> <p>它接着会自动打开浏览器，定位到我们的网站</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_16.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_7.png" width="1044" height="810"></a> </p> <p>下面，我们尝试将那个WebPart添加到页面上</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_18.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_8.png" width="1044" height="810"></a> </p> <p>点击“添加”之后 ，我们发现Visual Studio居然捕捉到了</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_20.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_9.png" width="1044" height="810"></a> </p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>再次按下F5</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_22.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_10.png" width="1044" height="810"></a> </p> <p>看起来的确不错，不是吗？就那么简单地按下了F5，到底发生了什么事情呢？</p> <ul> <li>F5 键暗含哪些动作？<br>构建新版本的 .wsp 文件<br>反激活/卸载功能<br>撤销/删除旧版本的 .wsp 文件<br>添加/部署新的 .wsp 文件<br>激活目标网站中的功能（通过网站 URL）<br>将调试程序附加到 W3WP.EXE 工作者进程（通过网站 URL）</li></ul> <p>我们退出调试模式，然后刷新页面，看看是否还有效果呢？当然没有，此时Visual Studio已经与网站断开了联系，那么有什么方法再次进行调试呢？</p> <p>答案很简单，我们可以自己进行附加嘛</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_26.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_12.png" width="1044" height="810"></a> </p> <p>等等，这里有好几个w3wp.exe进程呢，我们怎么知道那个是我们需要的呢？</p> <p>&nbsp;</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_24.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_11.png" width="1044" height="810"></a> </p> <p></p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_28.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20103_DBF0/image_thumb_13.png" width="1044" height="810"></a> </p> <p>&nbsp;</p> <p>另外，MOSS 2010还有一个新特性，就是所谓的开发人员仪表盘，我之前有一个文章介绍了</p> <p><a href="http://www.cnblogs.com/chenxizhang/archive/2010/04/04/1704106.html">http://www.cnblogs.com/chenxizhang/archive/2010/04/04/1704106.html</a></p> <p>&nbsp;</p> <p>可以看出，现在开发和调试都相对方便多了</p>