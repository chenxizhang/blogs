# 如何在Windows Service或者Windows Forms输出Console.Write的信息 
> 原文发表于 2010-04-21, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/21/1716773.html 


<p>我们很多人都喜欢在一些代码中使用Console.Write或者Console.WriteLine的方式输出一些信息，这种做法，如果用到控制台程序中，是很方便的。但是如果用到了Windows Service或者Windows Forms程序中，那么就不是那么好了，因为它们并没有所谓的Console。（如果我们是在Visual Studio中进行调试的话，会输出到一个Output窗口）</p> <p>先来看Windows Service的做法。我们可以将这个输出流重定向到一个文件。</p><pre class="csharpcode">            StreamWriter sw = <span class="kwrd">new</span> StreamWriter(<span class="str">"e:\\temp\\log.log"</span>);
            sw.AutoFlush = <span class="kwrd">true</span>;
            Console.SetOut(sw);</pre><pre class="csharpcode">&nbsp;</pre><pre class="csharpcode"><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsServiceWindowsFormsConsole.Write_63A7/image_2.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsServiceWindowsFormsConsole.Write_63A7/image_thumb.png" width="1052" height="353"></a> </pre><pre class="csharpcode">而在Windows Forms中呢，当然也可以像上面这样做，但是我们可能希望现在在窗体的一个文本框中，看下面的例子</pre><pre class="csharpcode">首先可以编写一个特殊的TextWriter</pre><pre class="csharpcode">
        <span class="kwrd">public</span> <span class="kwrd">class</span> TextBoxWriter : TextWriter
        {
            TextBoxBase _textbox;
            <span class="kwrd">public</span> TextBoxWriter(TextBoxBase textbox) {
                _textbox = textbox;
            }

            <span class="kwrd">public</span> <span class="kwrd">override</span> Encoding Encoding
            {
                get { <span class="kwrd">return</span> Encoding.UTF8; }
            }

            <span class="kwrd">public</span> <span class="kwrd">override</span> <span class="kwrd">void</span> WriteLine(<span class="kwrd">string</span> <span class="kwrd">value</span>)
            {
                <span class="kwrd">base</span>.WriteLine(<span class="kwrd">value</span>);
                _textbox.AppendText(<span class="kwrd">value</span> + Environment.NewLine);
            }
        }</pre>
<p>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
<font size="2" face="Consolas">然后使用该TextWriter来输出消息到窗体的一个文本框中</font></p><pre class="csharpcode">            TextBoxWriter tw = <span class="kwrd">new</span> TextBoxWriter(richTextBox1);
            Console.SetOut(tw);</pre>
<p>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsServiceWindowsFormsConsole.Write_63A7/image_4.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsServiceWindowsFormsConsole.Write_63A7/image_thumb_1.png" width="740" height="421"></a> </p>
<p>&nbsp;</p>
<p>当然，如果仅仅是为了做一些跟踪性的输出，则更推荐使用Trace，结合TraceListener来实现。因为Trace是可以有多个输出的，事实上，确实也有一个ConsoleTraceListener可以输出到屏幕上。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p><pre class="csharpcode">&nbsp;</pre><pre class="csharpcode">&nbsp;</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>