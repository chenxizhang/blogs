# node-mysql 在4.2.0的时候遇到的错误 
> 原文发表于 2015-10-18, 地址: http://www.cnblogs.com/chenxizhang/p/4888882.html 


<p>实际上这个问题折腾了几天。前一阵因为升级到了最新的4.2.0，发现mysql的应用就出错了，错误消息也比较奇怪</p> <h3>Handshake Inactivity Timeout - PROTOCOL_SEQUENCE_TIMEOUT</h3> <p>经过几次折腾查找，我最后意识到可能是跟版本有关系，切换了node的版本（到早期版本），果然是可以的。</p> <p>在github上面跟作者提了问题，确认最新的Node 4.2.1 已经不存在这个问题。</p> <p><a href="http://images2015.cnblogs.com/blog/9072/201510/9072-20151018083913163-1060336748.png"><img title="image" border="0" alt="image" src="http://images2015.cnblogs.com/blog/9072/201510/9072-20151018083914179-328889163.png" width="244" height="132"></a></p> <p>&nbsp;</p> <p>node的最新版本change log，可以参考 <a title="https://nodejs.org/en/blog/release/v4.2.1/" href="https://nodejs.org/en/blog/release/v4.2.1/">https://nodejs.org/en/blog/release/v4.2.1/</a></p> <p>&nbsp;</p><pre class="csharpcode"><span class="kwrd">var</span> express = require(<span class="str">"express"</span>);
<span class="kwrd">var</span> mysql = require(<span class="str">"mysql"</span>);

<span class="kwrd">var</span> router = express.Router();

router.get(<span class="str">"/"</span>, <span class="kwrd">function</span> (req, res, next) {

    <span class="kwrd">var</span> connection = mysql.createConnection({
        host: <span class="str">"localhost"</span>,
        user: <span class="str">"nodejs"</span>,
        password: <span class="str">"nodejs"</span>,
        database: <span class="str">"nodejs"</span>,
        port: 3306
    });


    connection.query(<span class="str">"select * from employees"</span>, <span class="kwrd">function</span> (err, rows, fields) {
        <span class="kwrd">if</span> (err) <span class="kwrd">throw</span> err;
        console.log(rows);
        connection.end();

        res.send(rows);
    });
});


module.exports = router;</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>