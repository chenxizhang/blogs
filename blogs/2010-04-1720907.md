# Excel：如何使用函数实现多表多条件汇总求和 
> 原文发表于 2010-04-26, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/26/1720907.html 


<p>有网友给我来信，提到下面这样一个问题，希望我能设法帮助解决</p> <p>工作簿中有好几个表格，例如下面的1,2,3,4,5。他们的格式都相近：部门，姓名，型号等等</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/image_2.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/image_thumb.png" width="1054" height="741"></a> </p> <p>现在是希望在“结果”这个工作表中对五个工作表的值进行汇总，而且要能按照部门和姓名进行筛选</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/image_4.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/image_thumb_1.png" width="1054" height="741"></a> </p> <p>这个问题可以通过以下公式来解决</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/image_6.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/image_thumb_2.png" width="1054" height="741"></a> </p> <p>=SUMPRODUCT((T(INDIRECT("'"&amp;{1,2,3,4,5}&amp;"'!A"&amp;ROW($2:$5)))=$A2)*N(INDIRECT("'"&amp;{1,2,3,4,5}&amp;"'!C"&amp;ROW($2:$5)))*(T(INDIRECT("'"&amp;{1,2,3,4,5}&amp;"'!B"&amp;ROW($2:$5)))=$B2))</p> <p>&nbsp;</p> <p>好多年不怎么深入去研究Excel了，现在Excel的水准也只跟一般用户差不多，写这个公式也费了不少脑筋<a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/%E5%A4%A7%E6%B1%97_2.gif" class="thickbox"><img title="大汗" border="0" alt="大汗" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/Excel_7B70/%E5%A4%A7%E6%B1%97_thumb.gif" width="42" height="42"></a></p>