# MOSS 2010：Visual Studio 2010开发体验（7）&mdash;&mdash;AJAX Web Part 
> 原文发表于 2010-04-05, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/05/1704800.html 


<p>AJAX，<em>Asynchronous JavaScript and XML</em> ，虽然并不是新鲜的技术，但几乎是一夜之间红遍了整个Internet，原因很简单，它提供了比较好的用户体验。现在谁都恨不得表明自己是熟悉AJAX的，虽然事实上并不见得如此。</p> <p>好吧，我们并不是讨论AJAX的一些细节，而是看看现在如何开发一个支持AJAX的WebPart</p> <p>先回想一下，以前我们该怎么做呢？我们需要安装一个AJAX Extension，然后可以用到一些控件。其实最难的并不是这些，而是我们需要去小心翼翼地修改SharePoint网站的那个web.config。不要小看这些工作，这足以让你打退堂鼓。</p> <p>MOSS 2010是天生支持AJAX的，尤其是ASP.NET所提供的AJAX框架，理应得到最优先的支持。让我们拭目以待</p> <p>1. 创建一个新的WebPart</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_2.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb.png" width="1044" height="810"></a> </p> <p>2. 添加Systme.Web.Extensions.dll的引用</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_4.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb_1.png" width="1044" height="810"></a> </p> <p>3. 切换到控件的设计视图，注意看工具箱中有一个AJAX Extensions的Group</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_6.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb_2.png" width="1044" height="810"></a> </p> <p>我们很显然会用到里面的UpdatePanel控件，这是ASP.NET AJAX框架中最常用的一个控件。</p> <p>作为演示目的，我这里用了一个Timer，我会让它每秒钟刷新一下lbCurrentTime这个Label，让它显示当前时间。</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_10.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb_4.png" width="1044" height="810"></a> </p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_12.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb_5.png" width="1044" height="810"></a> </p> <p>4. 部署这个解决方案，并在页面中添加这个WebPart</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_14.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb_6.png" width="1044" height="810"></a> </p> <p>&nbsp;</p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_16.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio20107AJAXWebPart_F81F/image_thumb_7.png" width="1044" height="810"></a> </p> <p>不要怀疑，这个WebPart的内容会每秒钟刷新一次，但页面并不需要刷新。这就是AJAX。</p> <p>当然，这肯定不是AJAX的全部，甚至连AJAX的最基本的都谈不上，你说的很对</p> <p>[注意]千万不要真的在你的应用中为了每秒钟刷新一下时间去这样做。你完全可以用Javascript实现同样的功能</p> <p>所以，我现在还是先将它删除为好，以免我的服务器被我弄崩溃了，呵呵</p>