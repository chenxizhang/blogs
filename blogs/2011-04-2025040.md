# Excel 2007 automation on top of a Windows Server 2008 x64 
> 原文发表于 2011-04-22, 地址: http://www.cnblogs.com/chenxizhang/archive/2011/04/22/2025040.html 


<p>今天在一个客户这边出来一个windows service的问题。这个service需要启动excel程序，并且对一些excel文件做一些操作。</p> <p>环境是：windows server 2008 x64+Excel 2007</p> <p>总是报告错误：(类似下面这样）</p> <p>Service cannot be started. System.Runtime.InteropServices.COMException (0x800A03EC): Microsoft Office Excel cannot access the file 'c:\temp\test.xls'. There are several possible reasons: <p>• The file name or path does not exist.<br>• The file is being used by another program.<br>• The workbook you are trying to save has the same name as a currently open workbook. <p>代码怎么看都是可以的，反复调试了service,问题最后解决了，大致有如下几点 <p>&nbsp; <h1>第一步：在服务器添加有关的一个目录</h1> <p>这个方案参考了<a href="http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required">http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required</a> <p>This solution is ... <p>・Windows 2008 Server x64<br>&nbsp; Please make this folder. <p>&nbsp; C:\Windows\SysWOW64\config\systemprofile\Desktop <p>・Windows 2008 Server x86 <p>&nbsp; Please make this folder. <p>&nbsp; C:\Windows\System32\config\systemprofile\Desktop <p>&nbsp; ...instead of dcomcnfg.exe. <p>This operation took away office automation problems in my system. <p>A Desktop folder seems to be necessary in the systemprofile folder to open file by Excel. <p>It disappears from Windows2008, Windows2003 had the folder,<br>and I think it cause this error. <p>I think it is safer than "registry hack". <p>If you try this solution, please let me know results. <p>&nbsp; <h1>第二步：设置服务与桌面交互</h1> <p><a href="http://www.xizhang.com/blogimages/2c5069bce804_E585/image.png"><img title="image" border="0" alt="image" src="http://www.xizhang.com/blogimages/2c5069bce804_E585/image_thumb.png" width="424" height="478"></a> <p>&nbsp; <h1>第三步：关闭服务器的UAC（这一步至关重要，调试了一个下午，就是因为这个问题卡住）</h1> <p>&nbsp;</p> <p><a href="http://www.xizhang.com/blogimages/2c5069bce804_E585/image_4.png"><img title="image" border="0" alt="image" src="http://www.xizhang.com/blogimages/2c5069bce804_E585/image_thumb_4.png" width="764" height="564"></a></p>