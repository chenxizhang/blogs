# MOSS 开发之服务帐号过期的问题 
> 原文发表于 2010-04-24, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/24/1719310.html 


<p>再次遇到了这个问题，大家知道一般MOSS的Web Application都需要有一个Application Pool，而且在Web Application里面也有几个地方会用到管理帐号。这个帐号一般是一个AD的帐号，而一般AD都有密码策略，规定密码必须多少时间修改一次。</p> <p>很显然，如果密码被修改了，则可能导致MOSS的Web Application无法运行，具体的错误是一个503错误，意思是说服务不可用（Service Unavailable)</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS_C8B8/image_2.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS_C8B8/image_thumb.png" width="1044" height="810"></a> </p> <p>&nbsp;</p> <p>那么如何来解决该问题呢，请参考下面文章的介绍</p> <p><a title="http://support.microsoft.com/kb/934838/en-us/" href="http://support.microsoft.com/kb/934838/en-us/">http://support.microsoft.com/kb/934838/en-us/</a></p> <p>&nbsp;</p> <p>我们一般可以通过一个脚本来快速实现这个功能</p> <p>@echo off<br>rem other app pools<br>echo *** Updating app pool passwords<br>"%commonprogramfiles%\Microsoft Shared\Web server extensions\12\BIN\Stsadm.exe" -o updateaccountpassword -userlogin %1 -password %2 -noadmin<br>rem central admin<br>echo *** Updating Central Admin password<br>"%commonprogramfiles%\Microsoft Shared\Web server extensions\12\BIN\Stsadm.exe" -o updatefarmcredentials -userlogin %1 -password %2<br>rem ssp - new<br>echo *** Updating ssp password for new installs<br>"%commonprogramfiles%\Microsoft Shared\Web server extensions\12\BIN\Stsadm.exe" -o editssp -title "SharedServices1" -ssplogin %1 -ssppassword %2<br>rem ssp - upgrade<br>echo *** Updating ssp password for upgraded installs<br>"%commonprogramfiles%\Microsoft Shared\Web server extensions\12\BIN\Stsadm.exe" -o editssp -title "Default Web Site" -ssplogin %1 -ssppassword %2<br>rem osearch<br>echo *** Updating osearch password<br>"%commonprogramfiles%\Microsoft Shared\Web server extensions\12\BIN\Stsadm.exe" -o osearch -farmserviceaccount %1 -farmservicepassword %2<br>echo *** MANUAL UPDATE NEEDED. To update the password, visit the SSP Web application page, click Search Settings, and then click Default Content Access Account. <br>rem spsearch<br>echo *** Updating spsearch password<br>"%commonprogramfiles%\Microsoft Shared\Web server extensions\12\BIN\Stsadm.exe" -o spsearch -farmserviceaccount %1 -farmservicepassword %2<br>echo *** Updating spsearch content access account<br>"%commonprogramfiles%\Microsoft Shared\web server extensions\12\BIN\stsadm.exe" -o spsearch -farmcontentaccessaccount %1 -farmcontentaccesspassword %2<br>rem restarting IIS<br>echo *** Doing soft restart of IIS<br>iisreset /noforce<br>echo on 