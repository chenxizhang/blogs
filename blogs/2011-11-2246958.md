# SharePoint 2010开发方面的课堂中整理有关问题 
> 原文发表于 2011-11-13, 地址: http://www.cnblogs.com/chenxizhang/archive/2011/11/13/2246958.html 


<p>这是我这几天在做一个SharePoint开发的课程的时候，大家提出的一些问题，及我的解答，分享给更多的朋友参考一下 <p>这个文档，也可以在这里下载 <p><a title="SharePoint2010开发方面的有关问题.pdf" href="http://files.cnblogs.com/chenxizhang/SharePoint2010%E5%BC%80%E5%8F%91%E6%96%B9%E9%9D%A2%E7%9A%84%E6%9C%89%E5%85%B3%E9%97%AE%E9%A2%98.pdf">SharePoint2010开发方面的有关问题.pdf</a> <p>&nbsp; <hr align="center" size="2" width="100%">  <ol> <li> <h1><b>对于</b><b>SharePoint</b><b>的体系结构不甚清楚，觉得有点乱</b><b></b></h1></li></ol> <p>了解了就不会觉得乱了，请理解 <p>1) 场è服务器è服务è应用程序è站点集è站点è子站点è列表(或库)è列表项目。请描述这个地址的含义：http://chenxizhang-pc/sites/training/sql <p>2) 不同的级别有不同的管理员，可以分工协作 <p>3) SharePoint 2007的SSP没有了，现在是一个松散式的服务应用程序的架构 <p>理解SharePoint的六大模块 <p>1) 站点 <p>2) 社区 <p>3) 内容 <p>4) 搜索 <p>5) 商业智能 <p>6) 应用集成 <p>理解SharePoint的三种定制开发场景 <p>1) 基于浏览器的定制（主题，母板页，页面，列表，库） <p>2) 使用SharePoint Designer的定制（权限，列表定义，外部数据，工作流，网站修改） <p>3) 使用Visual Studio的定制开发（全功能开发，可复用的解决方案） <ol start="2"> <li> <h1><b>经常因为密码过期的问题，导致服务器出现很多相关问题</b></h1></li></ol> <p>SharePoint 2010提供了配置账户，以及自动修改密码的功能，可以从根本上解决这个问题 <p>它会自动刷新AD中的密码，不需要额外的管理操作 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755327272.jpg"><img title="clip_image002" border="0" alt="clip_image002" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755339125.jpg" width="244" height="165"></a> <ol start="3"> <li> <h1><b>SharePoint</b><b>如何与后台的业务系统进行集成</b></h1></li></ol> <p>这个可以通过BCS服务来实现，基本架构是这样的： <p>外部列表è外部内容类型èBDC模型è后台数据源 <p>后台数据源可以是SQL Server或者其他任何数据源，如果是SQL Server的话，则直接通过配置就能完成，如果是其他数据源，则需要少量定制开发 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755348437.jpg"><img title="clip_image004" border="0" alt="clip_image004" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755352241.jpg" width="244" height="167"></a> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755361793.jpg"><img title="clip_image006" border="0" alt="clip_image006" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755374203.jpg" width="244" height="165"></a> <p>可以在网页里面增删改查 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755384943.jpg"><img title="clip_image008" border="0" alt="clip_image008" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755399304.jpg" width="244" height="165"></a> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755415268.jpg"><img title="clip_image010" border="0" alt="clip_image010" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755417677.jpg" width="244" height="177"></a> <p>同时，还可以同步到SharePoint workspace中进行脱机查看和编辑 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755438625.jpg"><img title="clip_image012" border="0" alt="clip_image012" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755444381.jpg" width="244" height="190"></a> <p>关于连接其他外部数据源的开发实例，可以参考我的其他一些博客文章 <p><a href="http://zzk.cnblogs.com/s?w=blog%3Achenxizhang%20bcs">http://zzk.cnblogs.com/s?w=blog%3Achenxizhang%20bcs</a> <ol start="4"> <li> <h1><b>网站集管理员如何管理自己的解决方案</b></h1></li></ol> <p>SharePoint 2010开始提供了两种不同的解决方案模型 <p>1. 服务器场解决方案，支持全功能的定制开发，可以用在任意的级别。需要管理员安装和部署。 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755456758.jpg"><img title="clip_image014" border="0" alt="clip_image014" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755469167.jpg" width="244" height="165"></a> <p>支持所有的项目类型 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755475654.jpg"><img title="clip_image016" border="0" alt="clip_image016" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755481411.jpg" width="244" height="220"></a> <p>和所有的项目条目 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755491279.jpg"><img title="clip_image018" border="0" alt="clip_image018" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/20111113075553534.jpg" width="244" height="233"></a> <p>2. 沙箱解决方案，支持部分功能的定制开发，只能用在具体的站点集，由站点集管理员安装和管理。受到沙盒安全模型的限制，很多代码不能被执行，而且每天能够使用的资源是有限的 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755553226.jpg"><img title="clip_image020" border="0" alt="clip_image020" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130755565635.jpg" width="244" height="165"></a> <p>一个大的原则就是：<b>凡是要访问到网站之外资源，例如磁盘文件，数据库，或者其他网站集的功能都是不支持的，而且代码能使用的命名空间也会被自动过滤</b>。 <p>沙箱解决方案中支持的项目类型 <p>1) Empty projects (to which you add only allowed project item types) <p>2) List Definition projects <p>3) Event Receiver projects, <p>4) Content Type projects. <p>不支持的项目类型 <p>1) Site Definition projects <p>2) Visual Web Part projects（这个项目类型，因为涉及到一个ascx文件需要部署到磁盘，默认是不支持的，但可以通过安装SharePoint PowerTools来提供这个支持） <p>3) Business Data Connectivity Model projects. <p>支持的项目条目类型 <p>1) Web Parts <p>2) List Definitions <p>3) Event Receivers <p>4) Content Types <p>不支持的项目条目类型 <p>1) Visual Web Parts <p>2) Application Pages <p>3) Business Data Connectivity Models <ol start="5"> <li> <h1><b>从SharePoint 2007</b><b>或者WSS 3.0</b><b>升级到SharePoint 2010</b><b>相关问题</b></h1></li></ol> <p>有三种升级方式 <p>1. 就地升级（in place upgrade），在原先的服务器场上面直接安装SharePoint 2010，安装配置过程中有一个升级选项。这种做法的好处是自动化，几乎不需要额外的操作，但风险较高，万一升级不成功，则可能无法还原到2007 <p>&nbsp; <p>2. 附加数据库进行迁移(attach content database) <p>a. 备份原先的内容数据库（通常是在SQL Server 2005中） <p>b. 将备份文件复制到SQL Server 2008, 还原数据库 <p>c. 通过Test-SPContentDatabase命令验证数据库是否可以附加到SharePoint 2010 <p>d. 在SharePoint 2010中新建一个Web Application <p>e. 通过Mount-SPContentDatabase命令进行附加 <p>&nbsp; <p>3. 界面的升级 <p>a. 通常需要手工执行这个操作，来完成原先2007站点集的页面样式的升级。 也可以在Mount-SPContentDatabase的时候，指定一个参数(-UpdateUserExperience) <p>b. 在站点操作菜单中有一个Visual Upgrade <ol start="6"> <li> <h1><b>万一数据库坏了如何快速切换的问题</b></h1></li></ol> <p>SharePoint 2010支持使用SQL Server的数据库镜像功能，来提供这方面的保护，实现高可用。 <p>可以在新建Web Application指定故障转移服务器 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130756001203.png"><img title="clip_image021" border="0" alt="clip_image021" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130756027483.png" width="166" height="244"></a> <p>也可以在后期再修改这个设置 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130756033447.jpg"><img title="clip_image023" border="0" alt="clip_image023" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130756045856.jpg" width="244" height="157"></a> <ol start="7"> <li><b>使用下来感觉SharePoint</b><b>比较慢，有没有什么优化的策略</b></li></ol> <p>SharePoint的性能调优是一个系统功能，大致的原则和思路如下 <p>1. 根据企业的业务情况进行测试 <p><a href="http://technet.microsoft.com/en-us/library/ff758659.aspx">http://technet.microsoft.com/en-us/library/ff758659.aspx</a> <p>2. 进行合理的服务器场软硬件规划，请参考如下的指导文档 <p><a href="http://technet.microsoft.com/en-us/library/ff758645.aspx">http://technet.microsoft.com/en-us/library/ff758645.aspx</a> <p>3. 优化数据库及其存储设计 <p><a href="http://technet.microsoft.com/zh-cn/library/cc298801.aspx">http://technet.microsoft.com/zh-cn/library/cc298801.aspx</a> <p>4. 考虑远程数据存储（RBS）的机制，将大对象放置在数据库之外 <p><a href="http://technet.microsoft.com/zh-cn/library/ee748649.aspx">http://technet.microsoft.com/zh-cn/library/ee748649.aspx</a> <p>5. 考虑对用户操作设置一定容量阀值，避免恶意的操作 <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/20111113075605151.jpg"><img title="clip_image025" border="0" alt="clip_image025" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/201111/201111130756062560.jpg" width="135" height="244"></a> <p>6. 考虑缓存的特性 <p>页面缓存和用户配置信息缓存<a href="http://msdn.microsoft.com/en-us/library/aa661294.aspx">http://msdn.microsoft.com/en-us/library/aa661294.aspx</a> <p>大对象缓存<a href="http://msdn.microsoft.com/en-us/library/aa604896.aspx">http://msdn.microsoft.com/en-us/library/aa604896.aspx</a> <p>7. 掌握SharePoint的监控手段，发现问题并调整 <p><a href="http://technet.microsoft.com/en-us/library/ff758658.aspx">http://technet.microsoft.com/en-us/library/ff758658.aspx</a>