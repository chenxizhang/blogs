# 收官之作：利用Microsoft Teams构建中大型社区的技术架构与运营经验 
> 原文发表于 2018-12-30, 地址: http://www.cnblogs.com/chenxizhang/p/10200588.html 


<p><span>这是我在 <a href="http://mp.weixin.qq.com/s?__biz=MjM5ODEyNjE5OA==&amp;mid=2455455491&amp;idx=1&amp;sn=9470d22a17f871f57a570772b46d20e8&amp;chksm=b160901a8617190c4138fcc59777a3e4a2e7e59ca75b6de9a68850c58fb5e090ea29d69cfe64&amp;scene=21" target="_blank"><span>精彩又一年：Microsoft Teams技术社区2018年度回顾和展望</span></a> 活动上面的主题分享，我用Microsoft Teams技术社区的实践经验，给大家整理和分享了技术架构和一些运营经验。
</span></p><p>
 </p><p><span>Microsoft Teams 设计用来作为团队协作的中枢，它不仅能很好地在组织内部工作，也能打破边界，实现与外部用户的无缝协作，而且这一切都是安全可控的。基于这种特性，它可以用来作为协会、技术社区、上下游合作联盟之类的承载。
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202729226-520920848.png" alt=""/><span>
		</span></p><p>
 </p><p><span>作为一个社区的创建者和管理者，你需要至少考虑如下几件事情
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202729666-1570125271.png" alt=""/><span>
		</span></p><p>
 </p><p><span>为了支持外部用户加入，管理员需要启用"来宾访问"，然后在创建团队（Team）的时候，要选择"公共"这个级别，同时作为团队的所有者，你还可以控制来宾的一些权限。
</span></p><p>
 </p><p><span>关于在Teams里面启用来宾访问，请参考 https://docs.microsoft.com/zh-cn/MicrosoftTeams/guest-access  的说明
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202729958-84707714.png" alt=""/><span>
		</span></p><p>
 </p><p><span>创建好社区后，你就需要考虑如何让用户报名以及如何将其加入到社区中来了。你可以使用Forms来收集用户信息，内部用户也可以自己直接加入，外部用户则需要所有者（Owner）添加。
</span></p><p>
 </p><p><span>请注意，添加外部用户，其实是比较复杂的一个过程，该账号必须先被添加到当前团队所属组织的Azure Active Directory中，作为一个合法用户账号，然后再将该账号添加到团队（Team）对应的Modern Group中。
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202730257-409514300.png" alt=""/><span>
		</span></p><p>
 </p><p><span>如果用户报名比较多，以上手工操作可能需要占用很多的时间。所以，我之前给大家分享过使用PowerShell脚本来完成。
</span></p><p>
 </p><p><span>详细脚本，请参考 https://github.com/chenxizhang/microsoftteams-scripts/blob/master/AddUsersToTeams.ps1 
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202730668-1924885554.png" alt=""/><span>
		</span></p><p><span>上述脚本从某种程度上可以实现半自动化，但如果你希望有更好的方案，请参考下面这个设计。完整的范例和说明，请参考 https://github.com/chenxizhang/microsoftteams-scripts/blob/master/README.md 
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202730955-1321184281.png" alt=""/><span>
		</span></p><p>
 </p><p><span>解决了如何添加和管理用户的问题，相信社区就逐渐会进入正轨，只要有比较好的内容和话题，也一定会有活跃的讨论和输出。那么接下来的问题就是，如何对社区成员的活动进行统计分析，例如
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202731299-415704834.png" alt=""/><span>
		</span></p><p>
 </p><p><span>关于这个需求，目前可以通过Microsoft Graph 接口来实现。该接口目前是在Beta阶段，而且需要管理员授权。
</span></p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202731568-2063170036.png" alt=""/><span>
		</span></p><p><span>下面是一个范例，可以读取出来消息的数据，以及有多少点赞等等信息
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202731856-68727213.png" alt=""/><span>
		</span></p><p>
 </p><p><span>欢迎加入Microsoft Teams技术社区，如果对演讲材料和脚本有兴趣，可以访问 https://github.com/chenxizhang/microsoftteams-scripts/blob/master/README.md 
</span></p><p>
 </p><p><img src="https://img2018.cnblogs.com/blog/9072/201812/9072-20181230202732189-2108513213.png" alt=""/><span>
		</span></p><p><span>
		</span> </p>