# 使用Windows Service Wrapper快速创建一个Windows Service 
> 原文发表于 2015-07-30, 地址: http://www.cnblogs.com/chenxizhang/p/4688051.html 


<h1>前言</h1> <p>今天介绍一个小工具的使用。我们都知道Windows Service是一种特殊的应用程序，它的好处是可以一直在后台运行，相对来说，比较适合一些需要一直运行同时不需要过多用户干预的应用程序，这一类我们称之为“服务”吧</p> <p>编写Windows Service其实是不难的，尤其是如果有Visual Studio的话。但是仍然是有不少童鞋觉得略显繁琐，同时，如果有一些其他的程序，我们只拿到一个exe，或者一个bat，但又想让他象服务一样运行，怎么办呢</p> <p>答案就是可以使用如下的一个工具，它的名称就叫：Windows Service Wrapper，简称WSW。</p> <h1>wsw的基本使用</h1> <p>一般的使用步骤是：</p> <p>1. 下载wsw的最新版本，放在任意的位置，修改成你想要的任何名字</p> <p>2.编写一个同名的xml文件</p> <p>3.使用Install命令进行安装</p> <p>4.如果想要卸载，则使用Uninstall命令</p> <p>&nbsp;</p> <p>&nbsp;</p> <p><a title="https://kenai.com/projects/winsw/pages/Home" href="https://kenai.com/projects/winsw/pages/Home">https://kenai.com/projects/winsw/pages/Home</a></p> <p>This project creates a wrapper executable that can be used to host any executable as an Windows service. <h3><a name="Download"></a>Download</h3> <p><a href="http://maven.dyndns.org/2/com/sun/winsw/winsw/">The binaries are available here</a> for download. <h3><a name="Usage"></a>Usage</h3> <p>During your development... <ol> <li>Take <code>winsw.exe</code> from the distribution, and rename it to your taste (such as <code>myapp.exe</code>)  <li>Write <code>myapp.xml</code> (see <a href="https://kenai.com/projects/winsw/pages/ConfigurationSyntax">Configuration Syntax</a> for more details)  <li>Place those two files side by side when you deploy your application, because that's how <code>winsw.exe</code> discovers its configuration.</li></ol> <p>At runtime... <ul> <li>To install a service, run <code>myapp.exe install</code> <li>To start a service, run <code>myapp.exe start</code> <li>To stop a service, run <code>myapp.exe stop</code> <li>To restart a service, run <code>myapp.exe restart</code> <li>To uninstall a service, run <code>myapp.exe uninstall</code></li></ul> <p>When there's a problem, these commands also report an error message to stderr. On a successful completion, these commands do no produce any output and exit with 0. <p>In addition, you can also run <code>myapp.exe status</code> to have it print out the current status of the service to stdout. Again, any error encountered during the processing would cause output to be reported to stderr. <p>All these commands use the same set of <a href="https://kenai.com/projects/winsw/pages/ExitCode">exit code</a> to indicate its result. <h4><a name="Deferred_File_Operations"></a>Deferred File Operations</h4> <p>To support self updating services, winsw offers a mechanism to perform file operations before a service start up. This is often necessary because Windows prevents files from overwritten while it's in use. <p>To perform file operations, write a text file (in the UTF-8 encoding) at <code>myapp.copies</code> (that is, it's in the same directory as<code>myapp.xml</code> but with a different file extension), and for each operation add one line: <ul> <li>To move a file, write "src&gt;dst". If the 'dst' file already exists it will be overwritten.</li></ul> <p>The success or failure of these operations will be recorded in the event log. <h3><a name="Contributions_Welcome"></a>Contributions Welcome</h3> <p>If you are interested in joining the project, let me know. I'm always interested in more committers. <p>&nbsp; <p>&nbsp; <p>配置文件的格式请参考：<a title="https://kenai.com/projects/winsw/pages/ConfigurationSyntax" href="https://kenai.com/projects/winsw/pages/ConfigurationSyntax">https://kenai.com/projects/winsw/pages/ConfigurationSyntax</a>&nbsp; <p>我的一个例子如下 <p><a href="http://images0.cnblogs.com/blog/9072/201507/300642185173049.png"><img title="image" border="0" alt="image" src="http://images0.cnblogs.com/blog/9072/201507/300642210951361.png" width="244" height="200"></a> <p>运行install后，在services.msc中可以看到这个服务</p> <p><a href="http://images0.cnblogs.com/blog/9072/201507/300642235951931.png"><img title="image" border="0" alt="image" src="http://images0.cnblogs.com/blog/9072/201507/300642254548330.png" width="244" height="180"></a></p> <p><a href="http://images0.cnblogs.com/blog/9072/201507/300642270486044.png"><img title="image" border="0" alt="image" src="http://images0.cnblogs.com/blog/9072/201507/300642289231971.png" width="217" height="244"></a></p> <p>&nbsp;</p> <p>&nbsp;</p> <h1>相关知识</h1> <p>在Windows系统里面，还有一类特殊的服务，他们都是用一个特殊的程序启动的（svchost），如下</p> <p><a href="http://images0.cnblogs.com/blog/9072/201507/300642303455268.png"><img title="image" border="0" alt="image" src="http://images0.cnblogs.com/blog/9072/201507/300642324548125.png" width="217" height="244"></a></p> <p>那么，这又是怎么一回事情呢？有兴趣的童鞋可以参考&nbsp; <a title="http://www.howtogeek.com/howto/windows-vista/what-is-svchostexe-and-why-is-it-running/" href="http://www.howtogeek.com/howto/windows-vista/what-is-svchostexe-and-why-is-it-running/">http://www.howtogeek.com/howto/windows-vista/what-is-svchostexe-and-why-is-it-running/</a></p> <p>&nbsp;</p> <p>在Linux系统上面，也有一个类似的工具（而且更加强大），supervisor，有兴趣的童鞋可以参考</p> <p><a title="http://supervisord.org/introduction.html" href="http://supervisord.org/introduction.html">http://supervisord.org/introduction.html</a></p>