# MOSS 2010:Visual Studio 2010开发体验（17）&mdash;&mdash;在Silverlight应用程序中访问客户端对象模型 
> 原文发表于 2010-04-28, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/28/1722759.html 


<p><a href="http://www.cnblogs.com/chenxizhang/archive/2010/04/26/1721653.html">上一篇</a>我们开始介绍到了客户端对象模型，这是MOSS 2010提供的一套全新的API，它允许我们在客户端应用程序（包括控制台，Windows Forms，或者Silverlight应用程序）能够方便地访问到SharePoint的数据和组件。典型的引用是列表数据查询。（但不仅限于此）</p> <p>我们这一篇将继续这个话题，我们来看看在Silverlight应用程序中如何使用客户端对象模型。这与之前的控制台应用程序还是有些不一样的。根本性的区别在于异步操作。</p> <p>&nbsp;</p> <p>【注意】在Silverlight中使用客户端对象模型访问SharePoint数据的做法有两种，一种是作为Web Part的一部分直接嵌入在SharePoint里面，这种做法相对比较简单。而另外一种做法是在独立的应用程序中，（不在SharePoint站点中），这时会遇到很多复杂的问题，例如跨域访问方面的限制等等。</p> <p>本篇我们讨论的是第一种做法</p> <p>&nbsp;</p> <h2>1. 创建一个简单的Silverlight应用程序</h2> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_2.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb.png" width="1044" height="810"></a> </p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_4.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_1.png" width="1044" height="810"></a> </p> <p></p> <p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_6.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_2.png" width="1044" height="810"></a> </p> <h2>2. 设计界面，我们可以加入一个DataGrid控件来做数据展示。</h2><pre class="csharpcode">&lt;UserControl xmlns:my=<span class="str">"clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"</span>  x:Class=<span class="str">"SilverlightApplication3.MainPage"</span>
    xmlns=<span class="str">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    xmlns:x=<span class="str">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
    xmlns:d=<span class="str">"http://schemas.microsoft.com/expression/blend/2008"</span>
    xmlns:mc=<span class="str">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
    mc:Ignorable=<span class="str">"d"</span>
    d:DesignHeight=<span class="str">"300"</span> d:DesignWidth=<span class="str">"400"</span>&gt;

    &lt;Grid x:Name=<span class="str">"LayoutRoot"</span> Background=<span class="str">"White"</span>&gt;

        &lt;my:DataGrid x:Name=<span class="str">"EmployeeList"</span> Margin=<span class="str">"20"</span> /&gt;
        
    &lt;/Grid&gt;
    
    
&lt;/UserControl&gt;</pre><pre class="csharpcode"></pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
然后，我们用少量的代码做一个测试，确认它能够正常工作 
<p>先不连接到SharePoint，我们在本地做一个范例</p><pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> System.Net;
<span class="kwrd">using</span> System.Windows;
<span class="kwrd">using</span> System.Windows.Controls;
<span class="kwrd">using</span> System.Windows.Documents;
<span class="kwrd">using</span> System.Windows.Input;
<span class="kwrd">using</span> System.Windows.Media;
<span class="kwrd">using</span> System.Windows.Media.Animation;
<span class="kwrd">using</span> System.Windows.Shapes;

<span class="kwrd">namespace</span> SilverlightApplication3
{
    <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> MainPage : UserControl
    {
        <span class="kwrd">public</span> MainPage()
        {
            InitializeComponent();
            Loaded += <span class="kwrd">new</span> RoutedEventHandler(MainPage_Loaded);
        }

        <span class="kwrd">void</span> MainPage_Loaded(<span class="kwrd">object</span> sender, RoutedEventArgs e)
        {
            List&lt;Employee&gt; emps = <span class="kwrd">new</span> List&lt;Employee&gt;();
            emps.Add(<span class="kwrd">new</span> Employee() { FirstName = <span class="str">"ares"</span>, LastName = <span class="str">"chen"</span> });
            EmployeeList.ItemsSource = emps;
        }
    }


    <span class="kwrd">public</span> <span class="kwrd">class</span> Employee
    {
        <span class="kwrd">public</span> <span class="kwrd">string</span> FirstName { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> LastName { get; set; }
    }
}
</pre>
<p>按下F5键调试，我们可以在浏览器中，看到如下的效果</p>
<p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_8.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_3.png" width="1044" height="810"></a> </p>
<p>还不错，我们一次就成功了（当然，这没有什么可值得骄傲的，呵呵）</p>
<p>&nbsp;</p>
<h2>3. 使用专用的客户端模型访问到SharePoint的数据</h2>
<p>注意，我们这里所说的“专用”二次，这是有两个特殊的程序集需要引用，他们的位置是在下面C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\LAYOUTS\ClientBin</p>
<p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_10.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_4.png" width="1044" height="810"></a> </p>
<p>所以，不用多说，添加他们</p>
<p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_12.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_5.png" width="1044" height="810"></a> </p>
<p>&nbsp;</p>
<p>然后，我们把<a href="http://www.cnblogs.com/chenxizhang/archive/2010/04/26/1721653.html">上一篇</a>的代码复制过来，看看能不能工作</p>
<p>&nbsp;</p><pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> System.Net;
<span class="kwrd">using</span> System.Windows;
<span class="kwrd">using</span> System.Windows.Controls;
<span class="kwrd">using</span> System.Windows.Documents;
<span class="kwrd">using</span> System.Windows.Input;
<span class="kwrd">using</span> System.Windows.Media;
<span class="kwrd">using</span> System.Windows.Media.Animation;
<span class="kwrd">using</span> System.Windows.Shapes;

<span class="kwrd">using</span> Microsoft.SharePoint.Client;


<span class="kwrd">namespace</span> SilverlightApplication3
{
    <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> MainPage : UserControl
    {
        <span class="kwrd">public</span> MainPage()
        {
            InitializeComponent();
            Loaded += <span class="kwrd">new</span> RoutedEventHandler(MainPage_Loaded);
        }

        <span class="kwrd">void</span> MainPage_Loaded(<span class="kwrd">object</span> sender, RoutedEventArgs e)
        {


            var url = <span class="str">"http://localhost:45223/sites/dev"</span>;

            <span class="kwrd">using</span> (ClientContext ctx = <span class="kwrd">new</span> ClientContext(url))
            {
                <span class="rem">//ctx.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;</span>
                Web web = ctx.Web;
                ctx.Load(web);
                ctx.Load(web.Lists);
                ctx.Load(web, w =&gt; w.Lists.Where(l =&gt; l.Title == <span class="str">"Employees"</span>));
                ctx.ExecuteQuery();

                List list = web.Lists[0];
                CamlQuery camlQuery = <span class="kwrd">new</span> CamlQuery();
                camlQuery.ViewXml = <span class="str">"&lt;View&gt;&lt;Query&gt;&lt;Where&gt;&lt;Lt&gt;&lt;FieldRef Name='Age' /&gt;&lt;Value Type='Number'&gt;60&lt;/Value&gt;&lt;/Lt&gt;&lt;/Where&gt;&lt;/Query&gt;&lt;RowLimit&gt;100&lt;/RowLimit&gt;&lt;/View&gt;"</span>;

                ListItemCollection collListItem = list.GetItems(camlQuery);

                ctx.Load(collListItem);
                ctx.ExecuteQuery();

                var emps = collListItem.Select(i =&gt; <span class="kwrd">new</span> Employee()
                {
                    FirstName = i[<span class="str">"FirstName"</span>].ToString(),
                    LastName = i[<span class="str">"LastName"</span>].ToString()
                });
                EmployeeList.ItemsSource = emps;


            }
        }
    }


    <span class="kwrd">public</span> <span class="kwrd">class</span> Employee
    {
        <span class="kwrd">public</span> <span class="kwrd">string</span> FirstName { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> LastName { get; set; }
    }
}
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>【注意】以上代码几乎和之前在Console里面一模一样</p>
<p>&nbsp;</p>
<p>按下F5键运行，我们却收到了一个错误</p>
<p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_14.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_6.png" width="1044" height="810"></a> </p>
<p>这其实是我们预见到的错误，之前我就说到过了，Silverlight程序所有的外部资源访问都要求是异步进行的。那就动手改一下吧</p>
<p>&nbsp;</p>
<p>首先为了做得更加完善些，我们在布局方面做了一下小的调整添加了错误消息提示的功能</p><pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">UserControl</span> <span class="attr">xmlns:my</span><span class="kwrd">="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"</span>  <span class="attr">x:Class</span><span class="kwrd">="SilverlightApplication5.MainPage"</span>
    <span class="attr">xmlns</span><span class="kwrd">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    <span class="attr">xmlns:x</span><span class="kwrd">="http://schemas.microsoft.com/winfx/2006/xaml"</span>
    <span class="attr">xmlns:d</span><span class="kwrd">="http://schemas.microsoft.com/expression/blend/2008"</span>
    <span class="attr">xmlns:mc</span><span class="kwrd">="http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
    <span class="attr">mc:Ignorable</span><span class="kwrd">="d"</span>
    <span class="attr">d:DesignHeight</span><span class="kwrd">="300"</span> <span class="attr">d:DesignWidth</span><span class="kwrd">="400"</span><span class="kwrd">&gt;</span>

    <span class="kwrd">&lt;</span><span class="html">Grid</span> <span class="attr">x:Name</span><span class="kwrd">="LayoutRoot"</span> <span class="attr">Background</span><span class="kwrd">="White"</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">StackPanel</span> <span class="attr">Margin</span><span class="kwrd">="20"</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">TextBlock</span> <span class="attr">x:Name</span><span class="kwrd">="ErrorMessage"</span>  <span class="attr">FontSize</span><span class="kwrd">="10"</span><span class="kwrd">&gt;&lt;/</span><span class="html">TextBlock</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">TextBlock</span> <span class="attr">Text</span><span class="kwrd">="Employee List"</span> <span class="attr">FontSize</span><span class="kwrd">="40"</span><span class="kwrd">&gt;&lt;/</span><span class="html">TextBlock</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">my:DataGrid</span> <span class="attr">x:Name</span><span class="kwrd">="Employees"</span> <span class="kwrd">/&gt;</span>
        <span class="kwrd">&lt;/</span><span class="html">StackPanel</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">Grid</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">UserControl</span><span class="kwrd">&gt;</span>
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>在设计视图中，看起来应该是这样的</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_22.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_10.png" width="1044" height="810"></a> </p>
<p>然后，我们的代码修改成下面这样</p><pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> System.Collections.Generic;
<span class="kwrd">using</span> System.Linq;
<span class="kwrd">using</span> System.Net;
<span class="kwrd">using</span> System.Windows;
<span class="kwrd">using</span> System.Windows.Controls;
<span class="kwrd">using</span> System.Windows.Documents;
<span class="kwrd">using</span> System.Windows.Input;
<span class="kwrd">using</span> System.Windows.Media;
<span class="kwrd">using</span> System.Windows.Media.Animation;
<span class="kwrd">using</span> System.Windows.Shapes;
<span class="kwrd">using</span> Microsoft.SharePoint.Client;

<span class="kwrd">namespace</span> SilverlightApplication5
{
    <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> MainPage : UserControl
    {
        <span class="kwrd">public</span> MainPage()
        {
            InitializeComponent();
            Loaded += <span class="kwrd">new</span> RoutedEventHandler(MainPage_Loaded);
        }

        <span class="kwrd">void</span> MainPage_Loaded(<span class="kwrd">object</span> sender, RoutedEventArgs e)
        {

            ClientContext ctx = ClientContext.Current;
            Web web = ctx.Web;
            ctx.Load(web);
            ctx.Load(web.Lists);
            ctx.Load(web, w =&gt; w.Lists.Where(l =&gt; l.Title == <span class="str">"Employees"</span>));
            ctx.ExecuteQueryAsync(
                <span class="kwrd">new</span> ClientRequestSucceededEventHandler((o, e1) =&gt;
                {
                    List list = web.Lists[0];
                    CamlQuery camlQuery = <span class="kwrd">new</span> CamlQuery();
                    camlQuery.ViewXml = <span class="str">"&lt;View&gt;&lt;Query&gt;&lt;Where&gt;&lt;Lt&gt;&lt;FieldRef Name='Age' /&gt;&lt;Value Type='Number'&gt;60&lt;/Value&gt;&lt;/Lt&gt;&lt;/Where&gt;&lt;/Query&gt;&lt;RowLimit&gt;100&lt;/RowLimit&gt;&lt;/View&gt;"</span>;
                    ListItemCollection collListItem = list.GetItems(camlQuery);
                    ctx.Load(collListItem);

                    ctx.ExecuteQueryAsync(
                        <span class="kwrd">new</span> ClientRequestSucceededEventHandler((obj, e3) =&gt;
                        {
                            <span class="kwrd">this</span>.Dispatcher.BeginInvoke(<span class="kwrd">new</span> Action(() =&gt;
                            {
                                List&lt;Employee&gt; emps = <span class="kwrd">new</span> List&lt;Employee&gt;();
                                <span class="kwrd">foreach</span> (var item <span class="kwrd">in</span> collListItem)
                                {
                                    emps.Add(<span class="kwrd">new</span> Employee()
                                    {
                                        FirstName = item[<span class="str">"FirstName"</span>].ToString(),
                                        LastName = item[<span class="str">"LastName"</span>].ToString(),
                                    });

                                }

                                Employees.ItemsSource = emps;
                            }));

                        }),
                        <span class="kwrd">new</span> ClientRequestFailedEventHandler((obj, e4) =&gt;
                        {
                            ErrorMessage.Text = e4.Exception.Message;
                        }));

                }),
                <span class="kwrd">new</span> ClientRequestFailedEventHandler((o, e2) =&gt;
                {
                    ErrorMessage.Text = e2.Exception.Message;
                }));

        }


        <span class="kwrd">public</span> <span class="kwrd">class</span> Employee
        {
            <span class="kwrd">public</span> <span class="kwrd">string</span> FirstName { get; set; }
            <span class="kwrd">public</span> <span class="kwrd">string</span> LastName { get; set; }
        }
    }
}
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p>【注意】因为是作为WebPart使用，所以访问SharePoint的地址不能硬编码，而且事实上也没有必要硬编码，因为它有一个ClientContext.Current属性可以获取当前的SharePoint站点的上下文引用</p>
<p>&nbsp;</p>
<p>接下来我们部署这个程序。因为我们需要将该Silverlight程序在MOSS中使用，所以需要将输出的结果复制到下面的目录</p>
<p>C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\LAYOUTS\ClientBin</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><a class="thickbox" href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_18.png"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_8.png" width="1044" height="810"></a> </p>
<p>然后在页面中添加一个Silverlight WebPart来显示它，部署完成之后，我们看到的效果大致如下</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_24.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010VisualStudio201017Silverlight_7B49/image_thumb_11.png" width="1044" height="810"></a> </p>
<p>&nbsp;</p>
<p>【注意】关于如何在MOSS中使用Silverlight Web Part，我之前也有一篇文章专门介绍。这里就不重复了。如果你还不熟悉，请参考下面的链接</p>
<p><a href="http://www.cnblogs.com/chenxizhang/archive/2010/04/06/1705132.html">http://www.cnblogs.com/chenxizhang/archive/2010/04/06/1705132.html</a></p>
<p>&nbsp;</p>
<p>【注意】大家请注意，我的那个目录为什么会有很多个Test.xap呢，其实这也是无奈之举。如果有兴趣测试的朋友会发现，假如你对Silverlight程序做了修改，即便你覆盖掉原来的文件，那么在页面中加载的xap还是之前的那个。这的确是一个很让人诧异的设计（Web Part是不是把那个xap保存起来了呢？），目前也只有这样通过修改名字来刷新Silverlight部件了。这个问题折腾了很久的时间。</p>
<p>下一篇我将继续讲解在独立的Silverlight应用程序中如何访问SharePoint数据。</p>