# 一个通用的报表显示窗口（WindowsForms) 
> 原文发表于 2010-03-29, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/03/29/1699401.html 


<p>这也是这两天课堂上的一个范例。我们考虑到有很多报表，不可能为所有的报表单独定义一个窗口来显示，所以最后重构成一个通用的窗口</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsForms_A5C0/image_6.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsForms_A5C0/image_thumb_2.png" width="681" height="461"></a> </p> <p>后台代码</p><pre class="csharpcode"><span class="kwrd">using</span> System;
<span class="kwrd">using</span> Microsoft.Reporting.WinForms;

<span class="kwrd">namespace</span> NorthwindApplication
{
    <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> ReportForm : NorthwindApplication.FormTemplate
    {
        <span class="kwrd">public</span> ReportForm()
        {
            InitializeComponent();
        }

        <span class="kwrd">public</span> ReportForm(
            <span class="kwrd">string</span> formTitle,
            <span class="kwrd">string</span> reportTitle,
            <span class="kwrd">string</span> reportPath,
            <span class="kwrd">params</span> ReportDataSource[] datasource)
            : <span class="kwrd">this</span>()
        {
            <span class="kwrd">this</span>.Text = formTitle;
            <span class="kwrd">this</span>.FormTitle.Text = reportTitle;
            <span class="kwrd">this</span>.reportViewer1.LocalReport.ReportPath = reportPath;
            <span class="kwrd">this</span>.reportViewer1.LocalReport.DataSources.Clear();
            <span class="kwrd">foreach</span> (var item <span class="kwrd">in</span> datasource)
            {
                <span class="kwrd">this</span>.reportViewer1.LocalReport.DataSources.Add(item);
            }

        }

        <span class="kwrd">private</span> <span class="kwrd">void</span> ReportForm_Load(<span class="kwrd">object</span> sender, EventArgs e)
        {

            <span class="kwrd">this</span>.reportViewer1.RefreshReport();
        }
    }
}
</pre>
<p>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
</p>
<p>主窗体调用代码</p><pre class="csharpcode">           <span class="rem">//这里读取数据，然后实例化报表，然后显示报表</span>
            var formTitle = <span class="str">"员工订单报表"</span>;
            var context = <span class="kwrd">new</span> NorthwindDataContext();

            var employee =
                context.Employees.Where(
                    emp =&gt; emp.EmployeeID == 1);

            

            <span class="kwrd">if</span> (employee != <span class="kwrd">null</span>)
            {
                var temp = employee.FirstOrDefault();
                var reportTitle = temp.FirstName + <span class="str">","</span> + temp.LastName;
                var reportPath = <span class="str">"EmployeeOrderReport.rdlc"</span>;

                ReportForm report = <span class="kwrd">new</span> ReportForm(
                    formTitle,
                    reportTitle,
                    reportPath,
                    <span class="kwrd">new</span> ReportDataSource(
                        <span class="str">"NorthwindApplication_Employees"</span>,
                        employee),
                    <span class="kwrd">new</span> ReportDataSource(
                        <span class="str">"NorthwindApplication_Orders"</span>,
                        temp.Orders.ToArray()));


                report.MdiParent = <span class="kwrd">this</span>;
                report.WindowState = FormWindowState.Maximized;
                report.Show();

            }</pre>
<p>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>
</p>
<p>窗体显示的大致效果如下</p><pre class="csharpcode">&nbsp;</pre><pre class="csharpcode"><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsForms_A5C0/image_4.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/WindowsForms_A5C0/image_thumb_1.png" width="879" height="598"></a> </pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>