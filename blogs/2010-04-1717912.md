# MOSS 2010:为视图添加参数显示的功能 
> 原文发表于 2010-04-22, 地址: http://www.cnblogs.com/chenxizhang/archive/2010/04/22/1717912.html 


<p>我们现在还可以根据一些参数来决定某个视图显示的数据。例如我们需要实现这样的场景：用户可以通过在地址栏中添加一些特殊的参数来对数据进行筛选</p> <p>首先仍然是来看一下效果先</p> <p>下面这个页面地址是：<a title="http://nymoss2010:45223/sites/dev/Lists/New%20Toy%20Ideas/AllItems.aspx?InitialTabId=Ribbon%2EListItem&amp;VisibilityContext=WSSTabPersistence" href="http://nymoss2010:45223/sites/dev/Lists/New%20Toy%20Ideas/AllItems.aspx?InitialTabId=Ribbon%2EListItem&amp;VisibilityContext=WSSTabPersistence">http://nymoss2010:45223/sites/dev/Lists/New%20Toy%20Ideas/AllItems.aspx?InitialTabId=Ribbon%2EListItem&amp;VisibilityContext=WSSTabPersistence</a></p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_2.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_thumb.png" width="1044" height="810"></a> </p> <p>下面这个地址是</p> <p><a title="http://nymoss2010:45223/sites/dev/Lists/New%20Toy%20Ideas/AllItems.aspx?InitialTabId=Ribbon%2EListItem&amp;VisibilityContext=WSSTabPersistence" href="http://nymoss2010:45223/sites/dev/Lists/New%20Toy%20Ideas/AllItems.aspx?InitialTabId=Ribbon%2EListItem&amp;VisibilityContext=WSSTabPersistence&amp;existing=1">http://nymoss2010:45223/sites/dev/Lists/New%20Toy%20Ideas/AllItems.aspx?InitialTabId=Ribbon%2EListItem&amp;VisibilityContext=WSSTabPersistence&amp;existing=1</a></p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_4.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_thumb_1.png" width="1044" height="810"></a> </p> <p>我们看到第二个界面上没有数据的.而他们地址栏的区别就在于第二个地址的最后面有&amp;exising=1，这表示要查找那些Existing Product为true（或1）的记录</p> <p>&nbsp;</p> <p>我们是如何让地址栏的这些参数影响到视图的呢？</p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_6.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_thumb_2.png" width="1044" height="810"></a> </p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_8.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_thumb_3.png" width="1044" height="810"></a> </p> <p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_10.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_thumb_4.png" width="1044" height="810"></a> </p> <p>就是这么容易。这让我想起了我们刚学ASP.NET 2的时候，不是有一个SqlDataSource控件么，也有这个特性的。</p> <p>难道他们之间有什么千丝万缕的关系么？大家根据下面的这些文本先琢磨一下</p> <p>&nbsp;</p><pre class="csharpcode">        <span class="kwrd">&lt;</span><span class="html">WebPartPages:XsltListViewWebPart</span> <span class="attr">runat</span><span class="kwrd">="server"</span> <span class="attr">Description</span><span class="kwrd">="Stores information about possible new toys"</span> </pre><pre class="csharpcode"><span class="attr">ListDisplayName</span><span class="kwrd">=""</span> <span class="attr">ImportErrorMessage</span><span class="kwrd">="无法导入此 Web 部件。"</span> <span class="attr">PartOrder</span><span class="kwrd">="2"</span> <span class="attr">Default</span><span class="kwrd">="TRUE"</span> <span class="attr">HelpLink</span><span class="kwrd">=""</span> <span class="attr">AllowRemove</span><span class="kwrd">="True"</span> <span class="attr">IsVisible</span><span class="kwrd">="True"</span> <span class="attr">AllowHide</span><span class="kwrd">="True"</span> </pre><pre class="csharpcode"><strong><span class="attr">UseSQLDataSourcePaging</span><span class="kwrd">="True"</span></strong> <span class="attr">ExportControlledProperties</span><span class="kwrd">="False"</span> <span class="attr">IsIncludedFilter</span><span class="kwrd">=""</span> <span class="attr">DataSourceID</span><span class="kwrd">=""</span> </pre><pre class="csharpcode"><span class="attr">Title</span><span class="kwrd">="New Toy Ideas"</span> <span class="attr">ViewFlag</span><span class="kwrd">="25165829"</span> <span class="attr">NoDefaultStyle</span><span class="kwrd">=""</span> <span class="attr">AllowConnect</span><span class="kwrd">="True"</span> <span class="attr">DisplayName</span><span class="kwrd">="所有项目"</span> <span class="attr">PageType</span><span class="kwrd">="PAGE_DEFAULTVIEW"</span> </pre><pre class="csharpcode"><span class="attr">FrameState</span><span class="kwrd">="Normal"</span> <span class="attr">PageSize</span><span class="kwrd">="-1"</span> <span class="attr">PartImageLarge</span><span class="kwrd">=""</span> <span class="attr">AsyncRefresh</span><span class="kwrd">="True"</span> <span class="attr">ExportMode</span><span class="kwrd">="NonSensitiveData"</span> </pre><pre class="csharpcode"><span class="attr">Dir</span><span class="kwrd">="Default"</span> <span class="attr">DetailLink</span><span class="kwrd">="/sites/dev/Lists/New Toy Ideas"</span> <span class="attr">ShowWithSampleData</span><span class="kwrd">="False"</span> </pre><pre class="csharpcode"><span class="attr">ListId</span><span class="kwrd">="726db811-0ef0-4fc2-863d-8ffd504f54ec"</span> <span class="attr">ListName</span><span class="kwrd">="{726DB811-0EF0-4FC2-863D-8FFD504F54EC}"</span> </pre><pre class="csharpcode"><span class="attr">FrameType</span><span class="kwrd">="Default"</span> <span class="attr">PartImageSmall</span><span class="kwrd">=""</span> <span class="attr">IsIncluded</span><span class="kwrd">="True"</span> <span class="attr">SuppressWebPartChrome</span><span class="kwrd">="False"</span> <span class="attr">AllowEdit</span><span class="kwrd">="True"</span> </pre><pre class="csharpcode"><span class="attr">ViewGuid</span><span class="kwrd">="{CE919B7F-878A-4789-BE21-F7CB8356B56F}"</span> <span class="attr">AutoRefresh</span><span class="kwrd">="False"</span> <span class="attr">AutoRefreshInterval</span><span class="kwrd">="60"</span> <span class="attr">AllowMinimize</span><span class="kwrd">="True"</span> </pre><pre class="csharpcode"><span class="attr">WebId</span><span class="kwrd">="00000000-0000-0000-0000-000000000000"</span> <span class="attr">ViewContentTypeId</span><span class="kwrd">="0x"</span> <span class="attr">InitialAsyncDataFetch</span><span class="kwrd">="False"</span> </pre><pre class="csharpcode"><span class="attr">GhostedXslLink</span><span class="kwrd">="main.xsl"</span> <span class="attr">MissingAssembly</span><span class="kwrd">="无法导入此 Web 部件。"</span> <span class="attr">HelpMode</span><span class="kwrd">="Modeless"</span> </pre><pre class="csharpcode"><span class="attr">ListUrl</span><span class="kwrd">=""</span> <span class="attr">ID</span><span class="kwrd">="g_ce919b7f_878a_4789_be21_f7cb8356b56f"</span> <span class="attr">ConnectionID</span><span class="kwrd">="00000000-0000-0000-0000-000000000000"</span> </pre><pre class="csharpcode"><span class="attr">AllowZoneChange</span><span class="kwrd">="True"</span> <span class="attr">TitleUrl</span><span class="kwrd">="/sites/dev/Lists/New Toy Ideas"</span> <span class="attr">ManualRefresh</span><span class="kwrd">="True"</span> <span class="attr">__MarkupType</span><span class="kwrd">="vsattributemarkup"</span> </pre><pre class="csharpcode"><span class="attr">__WebPartId</span><span class="kwrd">="{CE919B7F-878A-4789-BE21-F7CB8356B56F}"</span> <span class="attr">__AllowXSLTEditing</span><span class="kwrd">="true"</span> </pre><pre class="csharpcode"><span class="attr">__designer:CustomXsl</span><span class="kwrd">="fldtypes_Ratings.xsl"</span> <span class="attr">WebPart</span><span class="kwrd">="true"</span> <span class="attr">Height</span><span class="kwrd">=""</span> <span class="attr">Width</span><span class="kwrd">=""</span><span class="kwrd">&gt;&lt;</span><span class="html">ParameterBindings</span><span class="kwrd">&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="dvt_sortdir"</span> <span class="attr">Location</span><span class="kwrd">="Postback;Connection"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="dvt_sortfield"</span> <span class="attr">Location</span><span class="kwrd">="Postback;Connection"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="dvt_firstrow"</span> <span class="attr">Location</span><span class="kwrd">="Postback;Connection"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="OpenMenuKeyAccessible"</span> <span class="attr">Location</span><span class="kwrd">="Resource(wss,OpenMenuKeyAccessible)"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="open_menu"</span> <span class="attr">Location</span><span class="kwrd">="Resource(wss,open_menu)"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="select_deselect_all"</span> <span class="attr">Location</span><span class="kwrd">="Resource(wss,select_deselect_all)"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="idPresEnabled"</span> <span class="attr">Location</span><span class="kwrd">="Resource(wss,idPresEnabled)"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="NoAnnouncements"</span> <span class="attr">Location</span><span class="kwrd">="Resource(wss,noXinviewofY_LIST)"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="NoAnnouncementsHowTo"</span> <span class="attr">Location</span><span class="kwrd">="Resource(wss,noXinviewofY_DEFAULT)"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="UserID"</span> <span class="attr">Location</span><span class="kwrd">="CAMLVariable"</span> <span class="attr">DefaultValue</span><span class="kwrd">="CurrentUserName"</span><span class="kwrd">/&gt;</span>
            <span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="dvt_startposition"</span> <span class="attr">Location</span><span class="kwrd">="Postback"</span> <span class="attr">DefaultValue</span><span class="kwrd">=""</span><span class="kwrd">/&gt;</span>
            <strong><span class="kwrd">&lt;</span><span class="html">ParameterBinding</span> <span class="attr">Name</span><span class="kwrd">="Existing"</span> <span class="attr">Location</span><span class="kwrd">="QueryString(existing)"</span> <span class="attr">DefaultValue</span><span class="kwrd">="0"</span><span class="kwrd">/&gt;</span></strong>
        <span class="kwrd">&lt;/</span><span class="html">ParameterBindings</span><span class="kwrd">&gt;</span>
</pre>
<style type="text/css">.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</style>

<p></p>
<p></p>
<p></p>
<p></p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_12.png" class="thickbox"><img title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/chenxizhang/WindowsLiveWriter/MOSS2010_A4F3/image_thumb_5.png" width="1044" height="810"></a></p>